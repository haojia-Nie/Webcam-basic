{"remainingRequest":"/Users/haojianie/Desktop/Web/rppg-master/node_modules/babel-loader/lib/index.js!/Users/haojianie/Desktop/Web/rppg-master/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js??ref--13-0!/Users/haojianie/Desktop/Web/rppg-master/src/components/TSM.js","dependencies":[{"path":"/Users/haojianie/Desktop/Web/rppg-master/src/components/TSM.js","mtime":1597771575067},{"path":"/Users/haojianie/Desktop/Web/rppg-master/node_modules/cache-loader/dist/cjs.js","mtime":1597616075057},{"path":"/Users/haojianie/Desktop/Web/rppg-master/node_modules/babel-loader/lib/index.js","mtime":1597616074968},{"path":"/Users/haojianie/Desktop/Web/rppg-master/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js","mtime":1597616074257}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIi9Vc2Vycy9oYW9qaWFuaWUvRGVza3RvcC9XZWIvcnBwZy1tYXN0ZXIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3NsaWNlZFRvQXJyYXkiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIi9Vc2Vycy9oYW9qaWFuaWUvRGVza3RvcC9XZWIvcnBwZy1tYXN0ZXIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICIvVXNlcnMvaGFvamlhbmllL0Rlc2t0b3AvV2ViL3JwcGctbWFzdGVyL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCBfZ2V0IGZyb20gIi9Vc2Vycy9oYW9qaWFuaWUvRGVza3RvcC9XZWIvcnBwZy1tYXN0ZXIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2dldCI7CmltcG9ydCBfZ2V0UHJvdG90eXBlT2YgZnJvbSAiL1VzZXJzL2hhb2ppYW5pZS9EZXNrdG9wL1dlYi9ycHBnLW1hc3Rlci9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZ2V0UHJvdG90eXBlT2YiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIi9Vc2Vycy9oYW9qaWFuaWUvRGVza3RvcC9XZWIvcnBwZy1tYXN0ZXIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKaW1wb3J0IF9jcmVhdGVTdXBlciBmcm9tICIvVXNlcnMvaGFvamlhbmllL0Rlc2t0b3AvV2ViL3JwcGctbWFzdGVyL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVTdXBlciI7CmltcG9ydCAqIGFzIHRmIGZyb20gJ0B0ZW5zb3JmbG93L3RmanMnOwpleHBvcnQgdmFyIFRTTSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX3RmJGxheWVycyRMYXllcikgewogIF9pbmhlcml0cyhUU00sIF90ZiRsYXllcnMkTGF5ZXIpOwoKICB2YXIgX3N1cGVyID0gX2NyZWF0ZVN1cGVyKFRTTSk7CgogIGZ1bmN0aW9uIFRTTShjb25maWcpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUU00pOwoKICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBjb25maWcpOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFRTTSwgW3sKICAgIGtleTogImNvbXB1dGVPdXRwdXRTaGFwZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcHV0ZU91dHB1dFNoYXBlKGlucHV0U2hhcGUpIHsKICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tY29uc29sZSAqLwogICAgICAvL2NvbnNvbGUubG9nKGlucHV0U2hhcGUpOwogICAgICByZXR1cm4gaW5wdXRTaGFwZTsKICAgIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lCgogIH0sIHsKICAgIGtleTogImNhbGwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNhbGwoaW5wdXRzKSB7CiAgICAgIHZhciBpbnB1dCA9IGlucHV0c1swXTsKICAgICAgdmFyIG5fZnJhbWUgPSAyMDsgLy9pbnB1dC5wcmludCgxKTsKCiAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWNvbnNvbGUgKi8KICAgICAgLy9jb25zb2xlLmxvZyhpbnB1dHMpOwogICAgICAvL2NvbnNvbGUubG9nKCJUU00gaXMgc3RhcnRlZCBleGVjdXRpb24iKTsKCiAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWNvbnNvbGUgKi8KICAgICAgLy9jb25zb2xlLmxvZyhpbnB1dC5zaGFwZSk7CgogICAgICB2YXIgbnQsIGgsIHcsIGM7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZQoKICAgICAgdmFyIG91dCwgb3V0MSwgb3V0Miwgb3V0MywgZW1wdHk7CiAgICAgIHZhciBwYWRkaW5nMSwgcGFkZGluZzI7CiAgICAgIG50ID0gaW5wdXQuc2hhcGVbMF07CiAgICAgIGggPSBpbnB1dC5zaGFwZVsxXTsKICAgICAgdyA9IGlucHV0LnNoYXBlWzJdOwogICAgICBjID0gaW5wdXQuc2hhcGVbM107CiAgICAgIHZhciBmb2xkX2RpdiA9IDM7CiAgICAgIHZhciBmb2xkID0gTWF0aC5mbG9vcihjIC8gZm9sZF9kaXYpOwogICAgICB2YXIgbGFzdF9mb2xkID0gYyAtIChmb2xkX2RpdiAtIDEpICogZm9sZDsgLy9jb25zb2xlLmxvZyhmb2xkKQoKICAgICAgaW5wdXQgPSB0Zi5yZXNoYXBlKGlucHV0LCBbbnQsIGgsIHcsIGNdKTsKICAgICAgaW5wdXQgPSB0Zi5leHBhbmREaW1zKGlucHV0LCAwKTsKCiAgICAgIHZhciBfdGYkc3BsaXQgPSB0Zi5zcGxpdChpbnB1dCwgW2ZvbGQsIGZvbGQsIGxhc3RfZm9sZF0sIC0xKTsKCiAgICAgIHZhciBfdGYkc3BsaXQyID0gX3NsaWNlZFRvQXJyYXkoX3RmJHNwbGl0LCAzKTsKCiAgICAgIG91dDEgPSBfdGYkc3BsaXQyWzBdOwogICAgICBvdXQyID0gX3RmJHNwbGl0MlsxXTsKICAgICAgb3V0MyA9IF90ZiRzcGxpdDJbMl07CiAgICAgIC8vIFNoaWZ0IGxlZnQKICAgICAgcGFkZGluZzEgPSB0Zi56ZXJvcyhbb3V0MS5zaGFwZVswXSwgMSwgb3V0MS5zaGFwZVsyXSwgb3V0MS5zaGFwZVszXSwgZm9sZF0pOyAvL2NvbnNvbGUubG9nKHBhZGRpbmcxKTsKCiAgICAgIHZhciBfdGYkc3BsaXQzID0gdGYuc3BsaXQob3V0MSwgWzEsIG5fZnJhbWUgLSAxXSwgMSk7CgogICAgICB2YXIgX3RmJHNwbGl0NCA9IF9zbGljZWRUb0FycmF5KF90ZiRzcGxpdDMsIDIpOwoKICAgICAgZW1wdHkgPSBfdGYkc3BsaXQ0WzBdOwogICAgICBvdXQxID0gX3RmJHNwbGl0NFsxXTsKICAgICAgLy9jb25zb2xlLmxvZyhvdXQxKTsKICAgICAgLy9jb25zb2xlLmxvZyhlbXB0eSk7CiAgICAgIG91dDEgPSB0Zi5jb25jYXQoW291dDEsIHBhZGRpbmcxXSwgMSk7IC8vY29uc29sZS5sb2cob3V0MSk7CiAgICAgIC8vIFNoaWZ0IHJpZ2h0CgogICAgICBwYWRkaW5nMiA9IHRmLnplcm9zKFtvdXQyLnNoYXBlWzBdLCAxLCBvdXQyLnNoYXBlWzJdLCBvdXQyLnNoYXBlWzNdLCBmb2xkXSk7CgogICAgICB2YXIgX3RmJHNwbGl0NSA9IHRmLnNwbGl0KG91dDIsIFtuX2ZyYW1lIC0gMSwgMV0sIDEpOwoKICAgICAgdmFyIF90ZiRzcGxpdDYgPSBfc2xpY2VkVG9BcnJheShfdGYkc3BsaXQ1LCAyKTsKCiAgICAgIG91dDIgPSBfdGYkc3BsaXQ2WzBdOwogICAgICBlbXB0eSA9IF90ZiRzcGxpdDZbMV07CiAgICAgIG91dDIgPSB0Zi5jb25jYXQoW3BhZGRpbmcyLCBvdXQyXSwgMSk7CiAgICAgIG91dCA9IHRmLmNvbmNhdChbb3V0MSwgb3V0Miwgb3V0M10sIC0xKTsKICAgICAgb3V0ID0gdGYucmVzaGFwZShvdXQsIFstMSwgaCwgdywgY10pOwogICAgICByZXR1cm4gb3V0OwogICAgfQogIH0sIHsKICAgIGtleTogImdldENvbmZpZyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29uZmlnKCkgewogICAgICB2YXIgY29uZmlnID0gX2dldChfZ2V0UHJvdG90eXBlT2YoVFNNLnByb3RvdHlwZSksICJnZXRDb25maWciLCB0aGlzKS5jYWxsKHRoaXMpOwoKICAgICAgcmV0dXJuIGNvbmZpZzsKICAgIH0KICB9XSwgW3sKICAgIGtleTogImdldENsYXNzTmFtZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q2xhc3NOYW1lKCkgewogICAgICByZXR1cm4gJ1RTTSc7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gVFNNOwp9KHRmLmxheWVycy5MYXllcik7ClRTTS5jbGFzc05hbWUgPSAnVFNNJzsgLy8gc3RhdGljIHZhcmlhYmxl"},{"version":3,"sources":["/Users/haojianie/Desktop/Web/rppg-master/src/components/TSM.js"],"names":["tf","TSM","config","inputShape","inputs","input","n_frame","nt","h","w","c","out","out1","out2","out3","empty","padding1","padding2","shape","fold_div","fold","Math","floor","last_fold","reshape","expandDims","split","zeros","concat","layers","Layer","className"],"mappings":"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","sourcesContent":["import * as tf from '@tensorflow/tfjs';\r\n\r\nexport class TSM extends tf.layers.Layer {\r\n\r\n\tconstructor(config) {\r\n\t\tsuper(config);\r\n\t}\r\n\r\n\tcomputeOutputShape(inputShape) {\n\t\t/* eslint-disable no-console */\n\t\t//console.log(inputShape);\r\n\t\treturn inputShape;\r\n\t}\r\n\r\n\t// eslint-disable-next-line\r\n\tcall(inputs) {\r\n\n\t\tvar input = inputs[0];\n\t\tconst n_frame = 20;\n\t\t//input.print(1);\r\n\t\t/* eslint-disable no-console */\n\t\t//console.log(inputs);\n\t\t\r\n\t\t//console.log(\"TSM is started execution\");\r\n\t\t/* eslint-disable no-console */\r\n\t\t//console.log(input.shape);\r\n\t\tlet nt, h, w, c;\n\t\t// eslint-disable-next-line\r\n\t\tlet out, out1, out2, out3, empty;\r\n\t\tlet padding1, padding2;\n\t\tnt = input.shape[0];\n\t\th = input.shape[1];\n\t\tw = input.shape[2];\n\t\tc = input.shape[3];\n\t\t\r\n\t\tconst fold_div = 3;\r\n\t\tconst fold = Math.floor(c / fold_div);\r\n\t\tconst last_fold = c - (fold_div - 1) * fold;\n\t\t//console.log(fold)\r\n\t\tinput = tf.reshape(input, [nt, h, w, c]);\r\n\t\tinput = tf.expandDims(input, 0);\r\n\t\t[out1, out2, out3] = tf.split(input, [fold, fold, last_fold], -1)\r\n\r\n\t\t// Shift left\r\n\t\tpadding1 = tf.zeros([out1.shape[0], 1, out1.shape[2], out1.shape[3], fold]);\n\t\t\n\t\t//console.log(padding1);\r\n\t\t[empty, out1] = tf.split(out1, [1, n_frame - 1], 1);\n\t\t//console.log(out1);\n\t\t//console.log(empty);\r\n\t\tout1 = tf.concat([out1, padding1], 1);\n\t\t//console.log(out1);\r\n\r\n\t\t// Shift right\r\n\t\tpadding2 = tf.zeros([out2.shape[0], 1, out2.shape[2], out2.shape[3], fold]);\r\n\t\t[out2, empty] = tf.split(out2, [n_frame - 1, 1], 1);\r\n\t\tout2 = tf.concat([padding2, out2], 1);\r\n\r\n\t\tout = tf.concat([out1, out2, out3], -1);\r\n\t\tout = tf.reshape(out, [-1, h, w, c]);\r\n\r\n\t\treturn out;\r\n\t}\r\n\r\n\tgetConfig() {\r\n\t\tconst config = super.getConfig();\r\n\t\treturn config;\r\n\t}\r\n\r\n\tstatic getClassName() {\r\n\t\treturn 'TSM';\r\n\t}\n\t\r\n}\r\n\r\nTSM.className = 'TSM'; // static variable\n"]}]}