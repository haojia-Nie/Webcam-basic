{"remainingRequest":"/Users/haojianie/Desktop/Web/rppg-master/node_modules/babel-loader/lib/index.js!/Users/haojianie/Desktop/Web/rppg-master/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js??ref--13-0!/Users/haojianie/Desktop/Web/rppg-master/src/components/TSM.js","dependencies":[{"path":"/Users/haojianie/Desktop/Web/rppg-master/src/components/TSM.js","mtime":1597616873972},{"path":"/Users/haojianie/Desktop/Web/rppg-master/node_modules/cache-loader/dist/cjs.js","mtime":1597616075057},{"path":"/Users/haojianie/Desktop/Web/rppg-master/node_modules/babel-loader/lib/index.js","mtime":1597616074968},{"path":"/Users/haojianie/Desktop/Web/rppg-master/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js","mtime":1597616074257}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvVXNlcnMvaGFvamlhbmllL0Rlc2t0b3AvV2ViL3JwcGctbWFzdGVyL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiL1VzZXJzL2hhb2ppYW5pZS9EZXNrdG9wL1dlYi9ycHBnLW1hc3Rlci9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgX2dldCBmcm9tICIvVXNlcnMvaGFvamlhbmllL0Rlc2t0b3AvV2ViL3JwcGctbWFzdGVyL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9nZXQiOwppbXBvcnQgX2dldFByb3RvdHlwZU9mIGZyb20gIi9Vc2Vycy9oYW9qaWFuaWUvRGVza3RvcC9XZWIvcnBwZy1tYXN0ZXIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2dldFByb3RvdHlwZU9mIjsKaW1wb3J0IF9pbmhlcml0cyBmcm9tICIvVXNlcnMvaGFvamlhbmllL0Rlc2t0b3AvV2ViL3JwcGctbWFzdGVyL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9pbmhlcml0cyI7CmltcG9ydCBfY3JlYXRlU3VwZXIgZnJvbSAiL1VzZXJzL2hhb2ppYW5pZS9EZXNrdG9wL1dlYi9ycHBnLW1hc3Rlci9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlU3VwZXIiOwppbXBvcnQgX2RlZmluZVByb3BlcnR5IGZyb20gIi9Vc2Vycy9oYW9qaWFuaWUvRGVza3RvcC9XZWIvcnBwZy1tYXN0ZXIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5IjsKaW1wb3J0ICogYXMgdGYgZnJvbSAnQHRlbnNvcmZsb3cvdGZqcyc7CmV4cG9ydCB2YXIgVFNNID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfdGYkbGF5ZXJzJExheWVyKSB7CiAgX2luaGVyaXRzKFRTTSwgX3RmJGxheWVycyRMYXllcik7CgogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoVFNNKTsKCiAgZnVuY3Rpb24gVFNNKGNvbmZpZykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRTTSk7CgogICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIGNvbmZpZyk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoVFNNLCBbewogICAga2V5OiAiY29tcHV0ZU91dHB1dFNoYXBlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wdXRlT3V0cHV0U2hhcGUoaW5wdXRTaGFwZSkgewogICAgICByZXR1cm4gaW5wdXRTaGFwZTsKICAgIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lCgogIH0sIHsKICAgIGtleTogImNhbGwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNhbGwoaW5wdXQsIG5fZnJhbWUsIG5iX2ZpbHRlcnMsIGtlcm5lbF9zaXplLCBwYWRkaW5nLCBhY3RpdmF0aW9uKSB7CiAgICAgIHJldHVybiB0Zi50aWR5KCkoZnVuY3Rpb24gKCkgewogICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWNvbnNvbGUgKi8KICAgICAgICBjb25zb2xlLmxvZygiVFNNIGlzIHN0YXJ0ZWQgZXhlY3V0aW9uIik7CiAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tY29uc29sZSAqLwoKICAgICAgICBjb25zb2xlLmxvZyhpbnB1dC5zaGFwZSk7CiAgICAgICAgdmFyIG50LCBoLCB3LCBjOwogICAgICAgIHZhciBvdXQsIG91dDEsIG91dDIsIG91dDMsIGVtcHR5OwogICAgICAgIHZhciBwYWRkaW5nMSwgcGFkZGluZzI7CiAgICAgICAgdmFyIGZvbGRfZGl2ID0gMzsKICAgICAgICB2YXIgZm9sZCA9IE1hdGguZmxvb3IoYyAvIGZvbGRfZGl2KTsKICAgICAgICB2YXIgbGFzdF9mb2xkID0gYyAtIChmb2xkX2RpdiAtIDEpICogZm9sZDsKICAgICAgICBudCwgaCwgdywgYyA9IGlucHV0LnNoYXBlOwogICAgICAgIGlucHV0ID0gdGYucmVzaGFwZShpbnB1dCwgW25fZnJhbWUsIGgsIHcsIGNdKTsKICAgICAgICBpbnB1dCA9IHRmLmV4cGFuZERpbXMoaW5wdXQsIDApOwogICAgICAgIG91dDEsIG91dDIsIG91dDMgPSB0Zi5zcGxpdChpbnB1dCwgW2ZvbGQsIGZvbGQsIGxhc3RfZm9sZF0sIC0xKTsgLy8gU2hpZnQgbGVmdAoKICAgICAgICBwYWRkaW5nMSA9IHRmLnplcm9zTGlrZShbLTEsIDEsIGgsIHcsIGZvbGRdKTsKICAgICAgICBwYWRkaW5nMSA9IHRmLmV4cGFuZERpbXMocGFkZGluZzEsIDEpOwogICAgICAgIGVtcHR5LCBvdXQxID0gdGYuc3BsaXQob3V0MSwgWzEsIG5fZnJhbWUgLSAxXSwgMSk7CiAgICAgICAgb3V0MSA9IHRmLmNvbmNhdChbb3V0MSwgcGFkZGluZzFdLCAxKTsgLy8gc2hpZnQgcmlnaHQKCiAgICAgICAgcGFkZGluZzIgPSB0Zi56ZXJvc0xpa2UoWy0xLCAxLCBoLCB3LCBmb2xkXSk7CiAgICAgICAgcGFkZGluZzIgPSB0Zi5leHBhbmREaW1zKHBhZGRpbmcyLCAxKTsKICAgICAgICBvdXQyLCBlbXB0eSA9IHRmLnNwbGl0KG91dDIsIFtuX2ZyYW1lIC0gMSwgMV0sIDEpOwogICAgICAgIG91dDIgPSB0Zi5jb25jYXQoW3BhZGRpbmcyLCBvdXQyXSwgMSk7CiAgICAgICAgb3V0ID0gdGYuY29uY2F0KFtvdXQxLCBvdXQyLCBvdXQzXSwgLTEpOwogICAgICAgIG91dCA9IHRmLnJlc2hhcGUob3V0LCAoLTEsIGgsIHcsIGMpKTsKICAgICAgICBvdXQgPSB0Zi5sYXllcnMuY29udjJEKHsKICAgICAgICAgIGZpbHRlcnM6IG5iX2ZpbHRlcnMsCiAgICAgICAgICBrZXJuZWxTaXplOiBrZXJuZWxfc2l6ZSwKICAgICAgICAgIHBhZGRpbmc6IHBhZGRpbmcsCiAgICAgICAgICBhY3RpdmF0aW9uOiBhY3RpdmF0aW9uCiAgICAgICAgfSkuYXBwbHkob3V0KTsKICAgICAgICByZXR1cm4gb3V0OwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRDb25maWciLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldENvbmZpZygpIHsKICAgICAgdmFyIGNvbmZpZyA9IF9nZXQoX2dldFByb3RvdHlwZU9mKFRTTS5wcm90b3R5cGUpLCAiZ2V0Q29uZmlnIiwgdGhpcykuY2FsbCh0aGlzKTsKCiAgICAgIHJldHVybiBjb25maWc7CiAgICB9CiAgfV0sIFt7CiAgICBrZXk6ICJnZXRDbGFzc05hbWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldENsYXNzTmFtZSgpIHsKICAgICAgcmV0dXJuICdUU00nOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFRTTTsKfSh0Zi5sYXllcnMuTGF5ZXIpOwoKX2RlZmluZVByb3BlcnR5KFRTTSwgImNsYXNzTmFtZSIsICdUU00nKTsKClRTTS5jbGFzc05hbWUgPSAnVFNNJzsgLy8gc3RhdGljIHZhcmlhYmxl"},{"version":3,"sources":["/Users/haojianie/Desktop/Web/rppg-master/src/components/TSM.js"],"names":["tf","TSM","config","inputShape","input","n_frame","nb_filters","kernel_size","padding","activation","tidy","console","log","shape","nt","h","w","c","out","out1","out2","out3","empty","padding1","padding2","fold_div","fold","Math","floor","last_fold","reshape","expandDims","split","zerosLike","concat","layers","conv2D","filters","kernelSize","apply","Layer","className"],"mappings":";;;;;;;AAAA,OAAO,KAAKA,EAAZ,MAAoB,kBAApB;AAGA,WAAaC,GAAb;AAAA;;AAAA;;AAGC,eAAYC,MAAZ,EAAoB;AAAA;;AAAA,6BACbA,MADa;AAEnB;;AALF;AAAA;AAAA,uCAOoBC,UAPpB,EAOgC;AAC9B,aAAOA,UAAP;AACA,KATF,CAWC;;AAXD;AAAA;AAAA,yBAYMC,KAZN,EAYaC,OAZb,EAYsBC,UAZtB,EAYkCC,WAZlC,EAY+CC,OAZ/C,EAYwDC,UAZxD,EAYoE;AAClE,aAAOT,EAAE,CAACU,IAAH,GAAU,YAAM;AACtB;AACAC,QAAAA,OAAO,CAACC,GAAR,CAAY,0BAAZ;AACA;;AACAD,QAAAA,OAAO,CAACC,GAAR,CAAYR,KAAK,CAACS,KAAlB;AACA,YAAIC,EAAJ,EAAQC,CAAR,EAAWC,CAAX,EAAcC,CAAd;AACA,YAAIC,GAAJ,EAASC,IAAT,EAAeC,IAAf,EAAqBC,IAArB,EAA2BC,KAA3B;AACA,YAAIC,QAAJ,EAAcC,QAAd;AACA,YAAMC,QAAQ,GAAG,CAAjB;AACA,YAAMC,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWX,CAAC,GAAGQ,QAAf,CAAb;AACA,YAAMI,SAAS,GAAGZ,CAAC,GAAG,CAACQ,QAAQ,GAAG,CAAZ,IAAiBC,IAAvC;AACAZ,QAAAA,EAAE,EAAEC,CAAF,EAAKC,CAAL,EAAQC,CAAC,GAAGb,KAAK,CAACS,KAApB;AACAT,QAAAA,KAAK,GAAGJ,EAAE,CAAC8B,OAAH,CAAW1B,KAAX,EAAkB,CAACC,OAAD,EAAUU,CAAV,EAAaC,CAAb,EAAgBC,CAAhB,CAAlB,CAAR;AACAb,QAAAA,KAAK,GAAGJ,EAAE,CAAC+B,UAAH,CAAc3B,KAAd,EAAqB,CAArB,CAAR;AACAe,QAAAA,IAAI,EAAEC,IAAF,EAAQC,IAAI,GAAGrB,EAAE,CAACgC,KAAH,CAAS5B,KAAT,EAAgB,CAACsB,IAAD,EAAOA,IAAP,EAAaG,SAAb,CAAhB,EAAyC,CAAC,CAA1C,CAAnB,CAdsB,CAgBtB;;AACAN,QAAAA,QAAQ,GAAGvB,EAAE,CAACiC,SAAH,CAAa,CAAC,CAAC,CAAF,EAAK,CAAL,EAAQlB,CAAR,EAAWC,CAAX,EAAcU,IAAd,CAAb,CAAX;AACAH,QAAAA,QAAQ,GAAGvB,EAAE,CAAC+B,UAAH,CAAcR,QAAd,EAAwB,CAAxB,CAAX;AACAD,QAAAA,KAAK,EAAEH,IAAI,GAAGnB,EAAE,CAACgC,KAAH,CAASb,IAAT,EAAe,CAAC,CAAD,EAAId,OAAO,GAAG,CAAd,CAAf,EAAiC,CAAjC,CAAd;AACAc,QAAAA,IAAI,GAAGnB,EAAE,CAACkC,MAAH,CAAU,CAACf,IAAD,EAAOI,QAAP,CAAV,EAA4B,CAA5B,CAAP,CApBsB,CAsBtB;;AACAC,QAAAA,QAAQ,GAAGxB,EAAE,CAACiC,SAAH,CAAa,CAAC,CAAC,CAAF,EAAK,CAAL,EAAQlB,CAAR,EAAWC,CAAX,EAAcU,IAAd,CAAb,CAAX;AACAF,QAAAA,QAAQ,GAAGxB,EAAE,CAAC+B,UAAH,CAAcP,QAAd,EAAwB,CAAxB,CAAX;AACAJ,QAAAA,IAAI,EAAEE,KAAK,GAAGtB,EAAE,CAACgC,KAAH,CAASZ,IAAT,EAAe,CAACf,OAAO,GAAG,CAAX,EAAc,CAAd,CAAf,EAAiC,CAAjC,CAAd;AACAe,QAAAA,IAAI,GAAGpB,EAAE,CAACkC,MAAH,CAAU,CAACV,QAAD,EAAWJ,IAAX,CAAV,EAA4B,CAA5B,CAAP;AAEAF,QAAAA,GAAG,GAAGlB,EAAE,CAACkC,MAAH,CAAU,CAACf,IAAD,EAAOC,IAAP,EAAaC,IAAb,CAAV,EAA8B,CAAC,CAA/B,CAAN;AACAH,QAAAA,GAAG,GAAGlB,EAAE,CAAC8B,OAAH,CAAWZ,GAAX,GAAiB,CAAC,CAAD,EAAIH,CAAJ,EAAOC,CAAP,EAAUC,CAA3B,EAAN;AACAC,QAAAA,GAAG,GAAGlB,EAAE,CAACmC,MAAH,CAAUC,MAAV,CAAiB;AACtBC,UAAAA,OAAO,EAAE/B,UADa;AAEtBgC,UAAAA,UAAU,EAAE/B,WAFU;AAGtBC,UAAAA,OAAO,EAAEA,OAHa;AAItBC,UAAAA,UAAU,EAAEA;AAJU,SAAjB,EAKH8B,KALG,CAKGrB,GALH,CAAN;AAOA,eAAOA,GAAP;AACA,OAtCM,CAAP;AAuCA;AApDF;AAAA;AAAA,gCAsDa;AACX,UAAMhB,MAAM,qEAAZ;;AACA,aAAOA,MAAP;AACA;AAzDF;AAAA;AAAA,mCA2DuB;AACrB,aAAO,KAAP;AACA;AA7DF;;AAAA;AAAA,EAAyBF,EAAE,CAACmC,MAAH,CAAUK,KAAnC;;gBAAavC,G,eACO,K;;AAgEpBA,GAAG,CAACwC,SAAJ,GAAgB,KAAhB,C,CAAuB","sourcesContent":["import * as tf from '@tensorflow/tfjs';\r\n\r\n\r\nexport class TSM extends tf.layers.Layer {\r\n\tstatic className = 'TSM';\r\n\r\n\tconstructor(config) {\r\n\t\tsuper(config);\r\n\t}\r\n\r\n\tcomputeOutputShape(inputShape) {\r\n\t\treturn inputShape;\r\n\t}\r\n\r\n\t// eslint-disable-next-line\r\n\tcall(input, n_frame, nb_filters, kernel_size, padding, activation) {\r\n\t\treturn tf.tidy()(() => {\r\n\t\t\t/* eslint-disable no-console */\r\n\t\t\tconsole.log(\"TSM is started execution\");\r\n\t\t\t/* eslint-disable no-console */\r\n\t\t\tconsole.log(input.shape);\r\n\t\t\tlet nt, h, w, c;\r\n\t\t\tlet out, out1, out2, out3, empty;\r\n\t\t\tlet padding1, padding2;\r\n\t\t\tconst fold_div = 3;\r\n\t\t\tconst fold = Math.floor(c / fold_div);\r\n\t\t\tconst last_fold = c - (fold_div - 1) * fold;\r\n\t\t\tnt, h, w, c = input.shape;\r\n\t\t\tinput = tf.reshape(input, [n_frame, h, w, c]);\r\n\t\t\tinput = tf.expandDims(input, 0);\r\n\t\t\tout1, out2, out3 = tf.split(input, [fold, fold, last_fold], -1)\r\n\r\n\t\t\t// Shift left\r\n\t\t\tpadding1 = tf.zerosLike([-1, 1, h, w, fold])\r\n\t\t\tpadding1 = tf.expandDims(padding1, 1)\r\n\t\t\tempty, out1 = tf.split(out1, [1, n_frame - 1], 1)\r\n\t\t\tout1 = tf.concat([out1, padding1], 1)\r\n\r\n\t\t\t// shift right\r\n\t\t\tpadding2 = tf.zerosLike([-1, 1, h, w, fold])\r\n\t\t\tpadding2 = tf.expandDims(padding2, 1)\r\n\t\t\tout2, empty = tf.split(out2, [n_frame - 1, 1], 1)\r\n\t\t\tout2 = tf.concat([padding2, out2], 1)\r\n\r\n\t\t\tout = tf.concat([out1, out2, out3], -1)\r\n\t\t\tout = tf.reshape(out, (-1, h, w, c))\r\n\t\t\tout = tf.layers.conv2D({\r\n\t\t\t\tfilters: nb_filters,\r\n\t\t\t\tkernelSize: kernel_size,\r\n\t\t\t\tpadding: padding,\r\n\t\t\t\tactivation: activation\r\n\t\t\t}).apply(out)\r\n\r\n\t\t\treturn out;\r\n\t\t});\r\n\t}\r\n\r\n\tgetConfig() {\r\n\t\tconst config = super.getConfig();\r\n\t\treturn config;\r\n\t}\r\n\r\n\tstatic getClassName() {\r\n\t\treturn 'TSM';\r\n\t}\r\n\r\n}\r\n\r\nTSM.className = 'TSM'; // static variable\n"]}]}