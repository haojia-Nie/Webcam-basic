{"remainingRequest":"/Users/haojianie/Desktop/Web/rppg-master/node_modules/babel-loader/lib/index.js!/Users/haojianie/Desktop/Web/rppg-master/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js??ref--13-0!/Users/haojianie/Desktop/Web/rppg-master/src/components/sketch.js","dependencies":[{"path":"/Users/haojianie/Desktop/Web/rppg-master/src/components/sketch.js","mtime":1597944054410},{"path":"/Users/haojianie/Desktop/Web/rppg-master/node_modules/cache-loader/dist/cjs.js","mtime":1597616075057},{"path":"/Users/haojianie/Desktop/Web/rppg-master/node_modules/babel-loader/lib/index.js","mtime":1597616074968},{"path":"/Users/haojianie/Desktop/Web/rppg-master/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js","mtime":1597616074257}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiL1VzZXJzL2hhb2ppYW5pZS9EZXNrdG9wL1dlYi9ycHBnLW1hc3Rlci9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCAqIGFzIHZpcyBmcm9tICd2aXMtdGltZWxpbmUvc3RhbmRhbG9uZSc7CmltcG9ydCAqIGFzIHRmIGZyb20gJ0B0ZW5zb3JmbG93L3RmanMnOwppbXBvcnQgeyBBdHRlbnRpb25NYXNrIH0gZnJvbSAnLi9BdHRlbnRpb25NYXNrLmpzJzsKaW1wb3J0IHsgVFNNIH0gZnJvbSAnLi9UU00uanMnOwpleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBydW4oKSB7CiAgdmFyIHZpZGVvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZpZGVvJyk7CiAgdmFyIHBhdGggPSAiLi9tb2RlbC5qc29uIjsKICB2YXIgb3JpZ192LCBwcmV2RnJhbWU7IC8vWHN1YiwgZFhzdWIsIHByZXZGcmFtZTsKCiAgdmFyIGRpZmZCYXRjaCwgQmF0Y2g7CiAgdmFyIGRlbGF5ID0gMTA7CiAgdmFyIGJhdGNoX3NpemUgPSAyMDsKICB2YXIgYmF0Y2hfY291bnRlciA9IDA7CiAgdmFyIGRpbSA9IDM2OwogIHZhciBwcmVkaWN0aW9uOwogIHZhciBtb2RlbDsKICB2YXIgcHJlZGljdGlvbl9ycHBnLCBwcmVkaWN0aW9uX3Jlc3A7CiAgdmFyIHRfc3RhcnQsIHRfZW5kOwogIHZhciBvcmlnX2JhdGNoOyAvLyBSZWdpc3RlciBDdXNvbWl6ZWQgTGF5ZXJzCgogIHRmLnNlcmlhbGl6YXRpb24ucmVnaXN0ZXJDbGFzcyhUU00pOwogIHRmLnNlcmlhbGl6YXRpb24ucmVnaXN0ZXJDbGFzcyhBdHRlbnRpb25NYXNrKTsgLy8gTG9hZCBNTCBNb2RlbAoKICBsb2FkTW9kZWwoKTsKCiAgZnVuY3Rpb24gbG9hZE1vZGVsKCkgewogICAgcmV0dXJuIF9sb2FkTW9kZWwuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9IC8vIERlZmluaXRpb24gZm9yIHRoZSBsaW5lIGNoYXJ0IAoKCiAgZnVuY3Rpb24gX2xvYWRNb2RlbCgpIHsKICAgIF9sb2FkTW9kZWwgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICByZXR1cm4gdGYubG9hZExheWVyc01vZGVsKHBhdGgpOwoKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIG1vZGVsID0gX2NvbnRleHQuc2VudDsKCiAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tY29uc29sZSAqLwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJTdWNjZXNzZnVsbHkgbG9hZGVkIG1sIG1vZGVsIik7CgogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUpOwogICAgfSkpOwogICAgcmV0dXJuIF9sb2FkTW9kZWwuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9CgogIHZhciBuYW1lcyA9IFsidW5pZm9ybSJdOwogIHZhciBncm91cHMgPSBuZXcgdmlzLkRhdGFTZXQoKTsKICB2YXIgY29udGFpbmVyX3JwcGcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2hhcnRfcnBwZyIpOwogIHZhciBjb250YWluZXJfcmVzcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjaGFydF9yZXNwIik7CiAgdmFyIGRhdGFzZXRfcnBwZyA9IG5ldyB2aXMuRGF0YVNldCgpOwogIHZhciBkYXRhc2V0X3Jlc3AgPSBuZXcgdmlzLkRhdGFTZXQoKTsKICB2YXIgbm93ID0gdmlzLm1vbWVudCgpOwogIHZhciBvcHRpb25zX3JwcGcgPSB7CiAgICBkcmF3UG9pbnRzOiBmYWxzZSwKICAgIGRhdGFBeGlzOiB7CiAgICAgIHZpc2libGU6IHRydWUsCiAgICAgIGxlZnQ6IHsKICAgICAgICB0aXRsZTogewogICAgICAgICAgdGV4dDogImN1bXN1bSAgcnBwZyIKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBsZWdlbmQ6IGZhbHNlLAogICAgc3RhcnQ6IHZpcy5tb21lbnQoKS5hZGQoLTUsICJzZWNvbmRzIiksCiAgICAvLyBkaXNwbGF5IHN0YXJ0LCAgZW5kCiAgICBlbmQ6IHZpcy5tb21lbnQoKS5hZGQoMTAsICJzZWNvbmRzIikKICB9OwogIHZhciBvcHRpb25zX3Jlc3AgPSB7CiAgICBkcmF3UG9pbnRzOiBmYWxzZSwKICAgIGRhdGFBeGlzOiB7CiAgICAgIHZpc2libGU6IHRydWUsCiAgICAgIGxlZnQ6IHsKICAgICAgICB0aXRsZTogewogICAgICAgICAgdGV4dDogImN1bXN1bSAgcmVzcCIKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBsZWdlbmQ6IGZhbHNlLAogICAgc3RhcnQ6IHZpcy5tb21lbnQoKS5hZGQoLTUsICJzZWNvbmRzIiksCiAgICAvLyBkaXNwbGF5IHN0YXJ0LCAgZW5kCiAgICBlbmQ6IHZpcy5tb21lbnQoKS5hZGQoMTAsICJzZWNvbmRzIikKICB9OyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUKCiAgdmFyIGdyYXBoMmRfcnBwZyA9IG5ldyB2aXMuR3JhcGgyZChjb250YWluZXJfcnBwZywgZGF0YXNldF9ycHBnLCBncm91cHMsIG9wdGlvbnNfcnBwZyk7CiAgdmFyIGdyYXBoMmRfcmVzcCA9IG5ldyB2aXMuR3JhcGgyZChjb250YWluZXJfcmVzcCwgZGF0YXNldF9yZXNwLCBncm91cHMsIG9wdGlvbnNfcmVzcCk7IC8vIE5vdGU6IGNvdWxkIGRlbGV0ZSB0aGUgZ3JvdXAgLCBqdXN0IHVzZSBkYXRhc2V0CgogIGdyb3Vwcy5hZGQoewogICAgaWQ6IDAsCiAgICBjb250ZW50OiBuYW1lc1swXSwKICAgIG9wdGlvbnM6IHsKICAgICAgZHJhd1BvaW50czogZmFsc2UsCiAgICAgIGludGVycG9sYXRpb246IHsKICAgICAgICBwYXJhbWV0cml6YXRpb246ICJ1bmlmb3JtIgogICAgICB9CiAgICB9CiAgfSk7CiAgc3RhcnRWaWRlbygpOwoKICBmdW5jdGlvbiBsb29wKCkgewogICAgcmV0dXJuIF9sb29wLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfSAvLyBWaWRlbyBkYXRhIFByZXByb2Nlc3MKCgogIGZ1bmN0aW9uIF9sb29wKCkgewogICAgX2xvb3AgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIC8vIHVwZGF0ZSBGcmFtZQogICAgICAgICAgICAgIG9yaWdfdiA9IHRmLmJyb3dzZXIuZnJvbVBpeGVscyh2aWRlbyk7CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiBwcmVwcm9jZXNzKCk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgLy9sb29wKCk7CiAgICAgICAgICAgICAgc2V0VGltZW91dChsb29wLCBkZWxheSk7CgogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlMik7CiAgICB9KSk7CiAgICByZXR1cm4gX2xvb3AuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9CgogIGZ1bmN0aW9uIHByZXByb2Nlc3MoKSB7CiAgICByZXR1cm4gX3ByZXByb2Nlc3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9CgogIGZ1bmN0aW9uIF9wcmVwcm9jZXNzKCkgewogICAgX3ByZXByb2Nlc3MgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICB2YXIgWHN1YiwgZFhzdWIsIFhzdWIyOwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIFhzdWIgPSB0Zi5pbWFnZS5yZXNpemVCaWxpbmVhcihvcmlnX3YsIFtkaW0sIGRpbV0pOwogICAgICAgICAgICAgIFhzdWIgPSBYc3ViLmFzVHlwZSgnZmxvYXQzMicpLmRpdih0Zi5zY2FsYXIoMjU1KSk7CiAgICAgICAgICAgICAgWHN1YiA9IFhzdWIuZXhwYW5kRGltcygwKTsgLy8gKDEsIDM2LCAzNiwgMykKCiAgICAgICAgICAgICAgaWYgKHByZXZGcmFtZSA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICBwcmV2RnJhbWUgPSBYc3ViOwogICAgICAgICAgICAgICAgb3JpZ19iYXRjaCA9IG9yaWdfdjsKICAgICAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWNvbnNvbGUgKi8KCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygibmV3IGRhdGEgaW5pdGlhbGl6ZSIpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgICAgICAgICAvLyBGUkFNRSBESUZGOgogICAgICAgICAgICAgICAgZFhzdWIgPSB0Zi5kaXYodGYuc3ViKFhzdWIsIHByZXZGcmFtZSksIHRmLmFkZChYc3ViLCBwcmV2RnJhbWUpKTsKICAgICAgICAgICAgICAgIFhzdWIyID0gdGYuc3ViKFhzdWIsIHRmLm1lYW4oWHN1YikpOyAvLyBYc3ViID0gWHN1YiAtIFhzdWIubWVhbihheGlzID0gMCkKICAgICAgICAgICAgICAgIC8vIFNVQlRSQUNUIE1FQU4gT0YgSU1HOgoKICAgICAgICAgICAgICAgIGRYc3ViID0gdGYuZGl2KGRYc3ViLCB0Zi5tb21lbnRzKGRYc3ViKS52YXJpYW5jZS5zcXJ0KCkpOyAvLyBkeHN1YiAvIG5wLnN0ZChkeHN1YixkZG9mPTEpCgogICAgICAgICAgICAgICAgWHN1YjIgPSB0Zi5kaXYoWHN1YiwgdGYubW9tZW50cyhYc3ViMikudmFyaWFuY2Uuc3FydCgpKTsgLy8gWHN1YiA9IFhzdWIgLSBYc3ViLm1lYW4oYXhpcyA9IDApCgogICAgICAgICAgICAgICAgcHJldkZyYW1lID0gWHN1YjsKCiAgICAgICAgICAgICAgICBpZiAoYmF0Y2hfY291bnRlciA9PSAwKSB7CiAgICAgICAgICAgICAgICAgIEJhdGNoID0gdGYuY2FzdChYc3ViMiwgJ2Zsb2F0MzInKTsKICAgICAgICAgICAgICAgICAgZGlmZkJhdGNoID0gZFhzdWI7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBCYXRjaCA9IHRmLmNvbmNhdChbQmF0Y2gsIFhzdWIyXSk7IC8vIG5vdGUgdGhlIHhzdWIgaGVyZSBpcyBhZnRlciAKCiAgICAgICAgICAgICAgICAgIGRpZmZCYXRjaCA9IHRmLmNvbmNhdChbZGlmZkJhdGNoLCBkWHN1Yl0pOwogICAgICAgICAgICAgICAgICBvcmlnX2JhdGNoID0gdGYuY29uY2F0KFtvcmlnX3YsIG9yaWdfYmF0Y2hdKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBiYXRjaF9jb3VudGVyKys7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoIShiYXRjaF9jb3VudGVyID09IGJhdGNoX3NpemUpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDIxOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB0X3N0YXJ0ID0gcGVyZm9ybWFuY2Uubm93KCk7CiAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA4OwogICAgICAgICAgICAgIHJldHVybiBtb2RlbC5wcmVkaWN0KFtkaWZmQmF0Y2gsIEJhdGNoXSk7CgogICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgcHJlZGljdGlvbiA9IF9jb250ZXh0My5zZW50OwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKHByZWRpY3Rpb25bMF0uYXJyYXlTeW5jKCkpOwogICAgICAgICAgICAgIHByZWRpY3Rpb25fcnBwZyA9IHByZWRpY3Rpb25bMF0uY3Vtc3VtKCkuYXJyYXlTeW5jKCk7CiAgICAgICAgICAgICAgcHJlZGljdGlvbl9yZXNwID0gcHJlZGljdGlvblsxXS5jdW1zdW0oKS5hcnJheVN5bmMoKTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhwcmVkaWN0aW9uX3JwcGcpOwogICAgICAgICAgICAgIHRfZW5kID0gcGVyZm9ybWFuY2Uubm93KCk7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coInRvdGFsIHRpbWUgc3BlbmQgZm9yIG9uZSBCYXRjaCAiICsgKHRfZW5kIC0gdF9zdGFydCkpOwogICAgICAgICAgICAgIGFkZERhdGFQb2ludCgpOyAvLyBpbml0aWFsaXphdGlvbiBmb3IgdGhlIG5leHQgaXRlcmF0aW9uCgogICAgICAgICAgICAgIEJhdGNoID0gbnVsbDsKICAgICAgICAgICAgICBkaWZmQmF0Y2ggPSBudWxsOwogICAgICAgICAgICAgIG9yaWdfYmF0Y2ggPSBudWxsOwogICAgICAgICAgICAgIHByZXZGcmFtZSA9IG51bGw7CiAgICAgICAgICAgICAgYmF0Y2hfY291bnRlciA9IDA7CgogICAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTMpOwogICAgfSkpOwogICAgcmV0dXJuIF9wcmVwcm9jZXNzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfQoKICBmdW5jdGlvbiBzdGFydFZpZGVvKCkgewogICAgaWYgKG5hdmlnYXRvci5tZWRpYURldmljZXMgJiYgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEpIHsKICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoewogICAgICAgIHZpZGVvOiB0cnVlCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHN0cmVhbSkgewogICAgICAgIHZpZGVvLnNyY09iamVjdCA9IHN0cmVhbTsKICAgICAgICB2aWRlby5hZGRFdmVudExpc3RlbmVyKCJsb2FkZWRtZXRhZGF0YSIsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIHVzZWQgdG8gaGF2ZSBhbiBlIGhlcmUKICAgICAgICAgIHZpZGVvLnBsYXkoKTsKICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWNvbnNvbGUgKi8KCiAgICAgICAgICBjb25zb2xlLmxvZygiV2ViY2FtIHZpZGVvIHN1Y2Nlc3NmdWxseSBsb2FkZWQiKTsKICAgICAgICAgIGxvb3AoKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfSAvLyB0aGUgY2hhcnQKCgogIGZ1bmN0aW9uIGFkZERhdGFQb2ludCgpIHsKICAgIHZhciBpID0gMDsKCiAgICB3aGlsZSAoaSA8IDIwKSB7CiAgICAgIG5vdyA9IHZpcy5tb21lbnQoKTsKICAgICAgZGF0YXNldF9ycHBnLmFkZChbewogICAgICAgIHg6IG5vdywKICAgICAgICB5OiBwcmVkaWN0aW9uX3JwcGdbaV0sCiAgICAgICAgZ3JvdXA6IDAKICAgICAgfV0pOwogICAgICBkYXRhc2V0X3Jlc3AuYWRkKFt7CiAgICAgICAgeDogbm93LAogICAgICAgIHk6IHByZWRpY3Rpb25fcmVzcFtpXSwKICAgICAgICBncm91cDogMAogICAgICB9XSk7CiAgICAgIGkrKzsKICAgIH0KCiAgICBtb3ZlV2luZG93KCk7IC8vc2V0VGltZW91dChtb3ZlV2luZG93LCBkZWxheSk7CiAgfQoKICBmdW5jdGlvbiBtb3ZlV2luZG93KCkgewogICAgdmFyIHN0cmF0ZWd5ID0gJ3N0YXRpYyc7CiAgICB2YXIgcmFuZ2UgPSBncmFwaDJkX3JwcGcuZ2V0V2luZG93KCk7CiAgICBub3cgPSB2aXMubW9tZW50KCk7CiAgICB2YXIgaW50ZXJ2YWwgPSByYW5nZS5lbmQgLSByYW5nZS5zdGFydDsKCiAgICBpZiAobm93ID4gcmFuZ2UuZW5kKSB7CiAgICAgIGdyYXBoMmRfcnBwZy5zZXRXaW5kb3cobm93IC0gMC4xICogaW50ZXJ2YWwsIG5vdyArIDAuOSAqIGludGVydmFsKTsKICAgICAgZ3JhcGgyZF9yZXNwLnNldFdpbmRvdyhub3cgLSAwLjEgKiBpbnRlcnZhbCwgbm93ICsgMC45ICogaW50ZXJ2YWwpOwogICAgfQoKICAgIHN3aXRjaCAoc3RyYXRlZ3kpIHsKICAgICAgZGVmYXVsdDoKICAgICAgICAvLyAnc3RhdGljJwogICAgICAgIC8vIG1vdmUgdGhlIHdpbmRvdyA5MCUgdG8gdGhlIGxlZnQgd2hlbiBub3cgaXMgbGFyZ2VyIHRoYW4gdGhlIGVuZCBvZiB0aGUgd2luZG93CiAgICAgICAgaWYgKHJhbmdlID4gMTApIHsKICAgICAgICAgIGdyYXBoMmRfcnBwZy5zZXRXaW5kb3cobm93IC0gMC4xICogaW50ZXJ2YWwsIG5vdyArIDAuOSAqIGludGVydmFsKTsKICAgICAgICAgIGdyYXBoMmRfcmVzcC5zZXRXaW5kb3cobm93IC0gMC4xICogaW50ZXJ2YWwsIG5vdyArIDAuOSAqIGludGVydmFsKTsKICAgICAgICB9CgogICAgICAgIHNldFRpbWVvdXQobW92ZVdpbmRvdywgZGVsYXkpOwogICAgICAgIGJyZWFrOwogICAgfQogIH0KfQ=="},{"version":3,"sources":["/Users/haojianie/Desktop/Web/rppg-master/src/components/sketch.js"],"names":["vis","tf","AttentionMask","TSM","run","video","document","getElementById","path","orig_v","prevFrame","diffBatch","Batch","delay","batch_size","batch_counter","dim","prediction","model","prediction_rppg","prediction_resp","t_start","t_end","orig_batch","serialization","registerClass","loadModel","loadLayersModel","console","log","names","groups","DataSet","container_rppg","container_resp","dataset_rppg","dataset_resp","now","moment","options_rppg","drawPoints","dataAxis","visible","left","title","text","legend","start","add","end","options_resp","graph2d_rppg","Graph2d","graph2d_resp","id","content","options","interpolation","parametrization","startVideo","loop","browser","fromPixels","preprocess","setTimeout","Xsub","image","resizeBilinear","asType","div","scalar","expandDims","dXsub","sub","Xsub2","mean","moments","variance","sqrt","cast","concat","performance","predict","arraySync","cumsum","addDataPoint","navigator","mediaDevices","getUserMedia","then","stream","srcObject","addEventListener","play","i","x","y","group","moveWindow","strategy","range","getWindow","interval","setWindow"],"mappings":"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","sourcesContent":["import * as vis from 'vis-timeline/standalone';\r\nimport * as tf from '@tensorflow/tfjs';\r\nimport {\r\n\tAttentionMask\r\n} from './AttentionMask.js';\r\nimport {\r\n\tTSM\r\n} from './TSM.js';\r\n\r\nexport default function run() {\r\n\tlet video = document.getElementById('video');\r\n\tvar path = \"./model.json\";\r\n\tvar orig_v, prevFrame;\r\n\t//Xsub, dXsub, prevFrame;\r\n\tvar diffBatch, Batch;\r\n\tvar delay = 10;\r\n\tvar batch_size = 20;\r\n\tvar batch_counter = 0;\r\n\tvar dim = 36;\r\n\tvar prediction;\r\n\tlet model;\r\n\tlet prediction_rppg, prediction_resp;\r\n\tvar t_start, t_end;\r\n\tvar orig_batch;\r\n\r\n\t// Register Cusomized Layers\r\n\ttf.serialization.registerClass(TSM);\r\n\ttf.serialization.registerClass(AttentionMask);\r\n\r\n\t// Load ML Model\r\n\tloadModel();\r\n\tasync function loadModel() {\r\n\t\tmodel = await tf.loadLayersModel(path);\r\n\t\t/* eslint-disable no-console */\r\n\t\tconsole.log(\"Successfully loaded ml model\");\r\n\t}\r\n\r\n\t// Definition for the line chart \r\n\tvar names = [\"uniform\"];\r\n\tvar groups = new vis.DataSet();\r\n\tvar container_rppg = document.getElementById(\"chart_rppg\");\r\n\tvar container_resp = document.getElementById(\"chart_resp\");\r\n\tvar dataset_rppg = new vis.DataSet();\r\n\tvar dataset_resp = new vis.DataSet();\r\n\tvar now = vis.moment();\r\n\r\n\tvar options_rppg = {\r\n\t\tdrawPoints: false,\r\n\t\tdataAxis: {\r\n\t\t\tvisible: true,\r\n\t\t\tleft: {\r\n\t\t\t\ttitle: {\r\n\t\t\t\t\ttext: \"cumsum  rppg\",\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tlegend: false,\r\n\t\tstart: vis.moment().add(-5, \"seconds\"), // display start,  end\r\n\t\tend: vis.moment().add(10, \"seconds\"),\r\n\r\n\t};\r\n\r\n\tvar options_resp = {\r\n\t\tdrawPoints: false,\r\n\t\tdataAxis: {\r\n\t\t\tvisible: true,\r\n\t\t\tleft: {\r\n\t\t\t\ttitle: {\r\n\t\t\t\t\ttext: \"cumsum  resp\",\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tlegend: false,\r\n\t\tstart: vis.moment().add(-5, \"seconds\"), // display start,  end\r\n\t\tend: vis.moment().add(10, \"seconds\"),\r\n\r\n\t};\r\n\r\n\t// eslint-disable-next-line\r\n\tvar graph2d_rppg = new vis.Graph2d(container_rppg, dataset_rppg, groups, options_rppg);\r\n\tvar graph2d_resp = new vis.Graph2d(container_resp, dataset_resp, groups, options_resp);\r\n\r\n\t// Note: could delete the group , just use dataset\r\n\tgroups.add({\r\n\t\tid: 0,\r\n\t\tcontent: names[0],\r\n\t\toptions: {\r\n\t\t\tdrawPoints: false,\r\n\t\t\tinterpolation: {\r\n\t\t\t\tparametrization: \"uniform\",\r\n\t\t\t},\r\n\t\t},\r\n\t});\r\n\r\n\tstartVideo();\r\n\r\n\tasync function loop() {\r\n\t\t// update Frame\r\n\t\torig_v = tf.browser.fromPixels(video);\r\n\t\tawait preprocess();\r\n\t\t//loop();\r\n\t\tsetTimeout(loop, delay);\r\n\t}\r\n\r\n\t// Video data Preprocess\r\n\tasync function preprocess() {\r\n\r\n\t\tvar Xsub = tf.image.resizeBilinear(orig_v, [dim, dim]);\r\n\t\tXsub = Xsub.asType('float32').div(tf.scalar(255));\r\n\t\tXsub = Xsub.expandDims(0); // (1, 36, 36, 3)\r\n\r\n\t\tif (prevFrame == null) {\r\n\t\t\tprevFrame = Xsub;\r\n\t\t\torig_batch = orig_v;\r\n\t\t\t/* eslint-disable no-console */\r\n\t\t\tconsole.log(\"new data initialize\");\r\n\r\n\t\t} else {\r\n\t\t\t//--------------------------------------\r\n\r\n\t\t\t// FRAME DIFF:\r\n\t\t\tvar dXsub = tf.div(tf.sub(Xsub, prevFrame), tf.add(Xsub, prevFrame));\r\n\t\t\tvar Xsub2 = tf.sub(Xsub, tf.mean(Xsub)); // Xsub = Xsub - Xsub.mean(axis = 0)\r\n\t\t\t// SUBTRACT MEAN OF IMG:\r\n\t\t\tdXsub = tf.div(dXsub, tf.moments(dXsub).variance.sqrt()); // dxsub / np.std(dxsub,ddof=1)\r\n\t\t\tXsub2 = tf.div(Xsub, tf.moments(Xsub2).variance.sqrt()); // Xsub = Xsub - Xsub.mean(axis = 0)\r\n\r\n\t\t\tprevFrame = Xsub;\r\n\t\t\tif (batch_counter == 0) {\r\n\t\t\t\tBatch = tf.cast(Xsub2, 'float32');\r\n\t\t\t\tdiffBatch = dXsub;\r\n\t\t\t} else {\r\n\t\t\t\tBatch = tf.concat([Batch, Xsub2]) // note the xsub here is after \r\n\t\t\t\tdiffBatch = tf.concat([diffBatch, dXsub]);\r\n\t\t\t\torig_batch = tf.concat([orig_v, orig_batch]);\r\n\t\t\t}\r\n\t\t\tbatch_counter++;\r\n\t\t}\r\n\r\n\t\tif (batch_counter == batch_size) {\r\n\t\t\tt_start = performance.now();\r\n\t\t\tprediction = await model.predict([diffBatch, Batch]);\r\n\t\t\tconsole.log(prediction[0].arraySync());\r\n\t\t\tprediction_rppg = prediction[0].cumsum().arraySync();\r\n\t\t\tprediction_resp = prediction[1].cumsum().arraySync();\r\n\t\t\t\n\t\t\tconsole.log(prediction_rppg);\r\n\t\t\tt_end = performance.now();\r\n\t\t\t\n\t\t\tconsole.log(\"total time spend for one Batch \" + (t_end - t_start));\r\n\t\t\taddDataPoint();\n\t\t\t\r\n\t\t\t// initialization for the next iteration\r\n\t\t\tBatch = null;\r\n\t\t\tdiffBatch = null;\r\n\t\t\torig_batch = null;\r\n\t\t\tprevFrame = null;\r\n\t\t\tbatch_counter = 0;\r\n\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tfunction startVideo() {\r\n\t\tif (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\r\n\t\t\tnavigator.mediaDevices.getUserMedia({\r\n\t\t\t\tvideo: true\r\n\t\t\t}).then(function(stream) {\r\n\t\t\t\tvideo.srcObject = stream;\r\n\t\t\t\tvideo.addEventListener(\"loadedmetadata\", function() { // used to have an e here\r\n\t\t\t\t\tvideo.play();\r\n\t\t\t\t\t/* eslint-disable no-console */\r\n\t\t\t\t\tconsole.log(\"Webcam video successfully loaded\");\r\n\t\t\t\t\tloop();\r\n\t\t\t\t})\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t// the chart\r\n\tfunction addDataPoint() {\r\n\t\tvar i = 0;\r\n\t\twhile (i < 20) {\r\n\t\t\tnow = vis.moment()\r\n\t\t\tdataset_rppg.add([{\r\n\t\t\t\tx: now,\r\n\t\t\t\ty: prediction_rppg[i],\r\n\t\t\t\tgroup: 0\r\n\t\t\t}])\r\n\t\t\tdataset_resp.add([{\r\n\t\t\t\tx: now,\r\n\t\t\t\ty: prediction_resp[i],\r\n\t\t\t\tgroup: 0\r\n\t\t\t}])\r\n\t\t\ti++;\r\n\t\t}\r\n\t\tmoveWindow();\r\n\t\t//setTimeout(moveWindow, delay);\r\n\t}\r\n\r\n\tfunction moveWindow() {\r\n\r\n\t\tlet strategy = 'static';\r\n\t\tvar range = graph2d_rppg.getWindow();\r\n\t\tnow = vis.moment();\r\n\r\n\t\tvar interval = range.end - range.start;\r\n\r\n\t\tif (now > range.end) {\r\n\t\t\tgraph2d_rppg.setWindow(now - 0.1 * interval, now + 0.9 * interval);\r\n\t\t\tgraph2d_resp.setWindow(now - 0.1 * interval, now + 0.9 * interval);\r\n\t\t}\r\n\r\n\t\tswitch (strategy) {\r\n\t\t\tdefault: // 'static'\r\n\t\t\t\t// move the window 90% to the left when now is larger than the end of the window\r\n\t\t\t\tif (range > 10) {\r\n\t\t\t\t\tgraph2d_rppg.setWindow(now - 0.1 * interval, now + 0.9 * interval);\r\n\t\t\t\t\tgraph2d_resp.setWindow(now - 0.1 * interval, now + 0.9 * interval);\r\n\t\t\t\t}\r\n\t\t\t\tsetTimeout(moveWindow, delay);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n}\n"]}]}